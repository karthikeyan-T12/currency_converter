import tkinter as tk
from tkinter import ttk
from currency_converter import CurrencyConverter
from forex_python.bitcoin import BtcConverter

# â”€â”€â”€ GLOBAL SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Fiat currency converter (USD, INR, EUR, etc.)
fiat_converter = CurrencyConverter()

# Crypto (Bitcoin â†’ INR) converter
btc=BtcConverter()

# List of all fiat currencies, sorted alphabetically
currency_list = sorted(fiat_converter.currencies)


# â”€â”€â”€ FUNCTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

def convert_fiat():
    """
    Convert between any two fiat currencies (e.g. USD â†’ INR, EUR â†’ GBP).
    """
    try:
        amount = float(entry_amount.get())
        from_cur = combo_from.get()
        to_cur = combo_to.get()
        result = fiat_converter.convert(amount, from_cur, to_cur)
        label_result.config(text=f"{amount} {from_cur}  =  {round(result, 2)} {to_cur}")
        listbox_history.insert(tk.END, f"{amount} {from_cur} âœ {round(result, 2)} {to_cur}")
    except ValueError:
        label_result.config(text="Error: Enter a valid number for amount.")
    except Exception as e:
        label_result.config(text=f"Error: {e}")


def swap_fiat():
    """
    Swap the currently selected fiat currencies in the two comboboxes.
    """
    a = combo_from.get()
    b = combo_to.get()
    combo_from.set(b)
    combo_to.set(a)


import requests

def convert_btc_to_inr():
    try:
        btc_amount = float(entry_btc.get())
        url = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=inr"
        response = requests.get(url, timeout=5)
        data = response.json()
        rate_btc_to_inr = data["bitcoin"]["inr"]
        inr_value = btc_amount * rate_btc_to_inr
        label_btc_result.config(
            text=f"{btc_amount} BTC = â‚¹{round(inr_value, 2)} INR"
        )
        listbox_history.insert(
            tk.END, f"{btc_amount} BTC âœ â‚¹{round(inr_value, 2)} INR"
        )
    except ValueError:
        label_btc_result.config(text="Enter a valid BTC number.")
    except Exception as e:
        label_btc_result.config(text=f"Error: {e}")
# â”€â”€â”€ GUI SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

window = tk.Tk()
window.title("ğŸ’± Currency Converter (Fiat + Bitcoin)")
window.geometry("700x650")
window.configure(bg="#f7f9fc")


# â”€â”€â”€ TITLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

tk.Label(
    window,
    text="Currency Converter (Fiat + BTC â†’ INR)",
    font="Helvetica 22 bold",
    bg="#f7f9fc"
).pack(pady=20)


# â”€â”€â”€ FIAT CONVERSION SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Amount Label & Entry
tk.Label(
    window,
    text="Amount:",
    font="Helvetica 14",
    bg="#f7f9fc"
).place(x=40, y=80)

entry_amount = tk.Entry(window, width=25, font="Helvetica 12")
entry_amount.place(x=250, y=85)

# Fromâ€Currency Dropdown
tk.Label(
    window,
    text="From (select):",
    font="Helvetica 14",
    bg="#f7f9fc"
).place(x=40, y=130)

combo_from = ttk.Combobox(
    window,
    values=currency_list,
    state="readonly",
    width=22,
    font="Helvetica 12"
)
combo_from.place(x=250, y=135)
combo_from.set("USD")  # default

# Toâ€Currency Dropdown
tk.Label(
    window,
    text="To (select):",
    font="Helvetica 14",
    bg="#f7f9fc"
).place(x=40, y=180)

combo_to = ttk.Combobox(
    window,
    values=currency_list,
    state="readonly",
    width=22,
    font="Helvetica 12"
)
combo_to.place(x=250, y=185)
combo_to.set("INR")  # default

# Convert & Swap Buttons
tk.Button(
    window,
    text="Convert Fiat",
    font="Helvetica 12",
    width=12,
    command=convert_fiat
).place(x=250, y=235)

tk.Button(
    window,
    text="Swap",
    font="Helvetica 12",
    width=8,
    command=swap_fiat
).place(x=370, y=235)

# Result label for fiat conversion
label_result = tk.Label(
    window,
    text="",
    font="Helvetica 14 bold",
    fg="darkgreen",
    bg="#f7f9fc",
    wraplength=600
)
label_result.place(x=40, y=290)


# â”€â”€â”€ BTC â†’ INR SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

tk.Label(
    window,
    text="Bitcoin â†’ INR Conversion",
    font="Helvetica 18 bold underline",
    bg="#f7f9fc"
).place(x=40, y=350)

# BTC Amount Label & Entry
tk.Label(
    window,
    text="BTC Amount:",
    font="Helvetica 14",
    bg="#f7f9fc"
).place(x=40, y=390)

entry_btc = tk.Entry(window, width=25, font="Helvetica 12")
entry_btc.place(x=250, y=395)

# Convert BTC Button
tk.Button(
    window,
    text="Convert BTC â†’ INR",
    font="Helvetica 12",
    width=16,
    command=convert_btc_to_inr
).place(x=250, y=445)

# Result label for BTC conversion
label_btc_result = tk.Label(
    window,
    text="",
    font="Helvetica 14 bold",
    fg="darkred",
    bg="#f7f9fc",
    wraplength=600
)
label_btc_result.place(x=40, y=500)


# â”€â”€â”€ CONVERSION HISTORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

tk.Label(
    window,
    text="Conversion History:",
    font="Helvetica 14",
    bg="#f7f9fc"
).place(x=40, y=550)

listbox_history = tk.Listbox(window, width=80, height=6, font="Helvetica 12")
listbox_history.place(x=40, y=580)


# â”€â”€â”€ START MAIN LOOP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

window.mainloop()
